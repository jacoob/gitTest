f2 is changed in mahdi branch.